; ========================================
; Generated by ttlx 1.0.0
; Source: test-config.yml
; Generated at: 2026-01-01 06:49:29
; ========================================

; === Variables ===
timeout = 30

; === Step 1: bastion ===
:CONNECT_BASTION
connect 'localhost:2222 /ssh /auth=password /user=testuser'
if result <> 0 then
    goto :ERROR_CONNECT_BASTION
endif
wait '$' timeout
if result = 0 then
    goto :TIMEOUT_BASTION
endif

; Password authentication
sendln 'testpass123'

; Command: hostname
sendln 'hostname'
wait '$' timeout
if result = 0 then
    goto :TIMEOUT_BASTION
endif

; === Step 2: target ===
sendln 'ssh testuser@target'
wait 'password:' timeout
if result = 0 then
    goto :TIMEOUT_TARGET
endif

; Password authentication
sendln 'testpass123'

; Command: hostname
sendln 'hostname'
wait '$' timeout
if result = 0 then
    goto :TIMEOUT_TARGET
endif

; Command: ls -la
sendln 'ls -la'
wait '$' timeout
if result = 0 then
    goto :TIMEOUT_TARGET
endif

:SUCCESS
closett
end

:ERROR_CONNECT_BASTION
messagebox 'Failed to connect to bastion' 'Error'
goto :CLEANUP

:TIMEOUT_BASTION
messagebox 'Connection timeout: bastion' 'Error'
goto :CLEANUP

:TIMEOUT_TARGET
messagebox 'Connection timeout: target' 'Error'
goto :CLEANUP

:CLEANUP
closett
end
